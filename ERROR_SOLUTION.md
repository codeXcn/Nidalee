# è°ƒç”¨ç”¨æˆ·ä¿¡æ¯æŠ¥é”™ - è§£å†³æ–¹æ¡ˆ

## ğŸ” é—®é¢˜åˆ†æ

è°ƒç”¨ç”¨æˆ·ä¿¡æ¯æ—¶å‡ºç°æŠ¥é”™ï¼Œä¸»è¦åŸå› æ˜¯ï¼š

### 1. HTTPSè¯ä¹¦éªŒè¯é—®é¢˜
League Clientä½¿ç”¨**è‡ªç­¾åè¯ä¹¦**ï¼Œæµè§ˆå™¨çš„fetch APIä¼šæ‹’ç»è¿™äº›è¿æ¥ï¼Œå¯¼è‡´ä»¥ä¸‹é”™è¯¯ï¼š
- `certificate verification failed`
- `self-signed certificate`
- `SSL connection error`

### 2. ç½‘ç»œè¿æ¥é—®é¢˜
- é˜²ç«å¢™é˜»æ­¢è¿æ¥
- League Clientæœªè¿è¡Œ
- ç«¯å£ä¸å¯è¾¾

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨Tauriå‘½ä»¤ç»•è¿‡è¯ä¹¦éªŒè¯ï¼ˆå·²å®ç°ï¼‰

æˆ‘å·²ç»å®ç°äº†ä¸€ä¸ªæ–°çš„Tauriå‘½ä»¤ `call_lcp_api`ï¼Œå®ƒåœ¨Ruståç«¯ä½¿ç”¨ `reqwest` å®¢æˆ·ç«¯ï¼Œé…ç½®äº†ï¼š
```rust
let client = reqwest::ClientBuilder::new()
    .danger_accept_invalid_certs(true)  // å¿½ç•¥æ— æ•ˆè¯ä¹¦
    .danger_accept_invalid_hostnames(true)  // å¿½ç•¥ä¸»æœºåéªŒè¯
    .build()?;
```

### æ–¹æ¡ˆ2ï¼šè¯¦ç»†çš„é”™è¯¯è¯Šæ–­

æ·»åŠ äº†ç½‘ç»œè¯Šæ–­å·¥å…· `diagnoseLCPConnection`ï¼Œå¯ä»¥ï¼š
- æµ‹è¯•ç«¯å£è¿é€šæ€§
- åˆ†æé”™è¯¯ç±»å‹
- æä¾›è§£å†³å»ºè®®

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è‡ªåŠ¨ä½¿ç”¨ï¼ˆæ¨èï¼‰
å¯åŠ¨Nidaleeå’ŒLeague Clientï¼Œåº”ç”¨ä¼šè‡ªåŠ¨ï¼š
1. è¿æ¥åˆ°æ¸¸æˆå®¢æˆ·ç«¯
2. ä½¿ç”¨Tauriå‘½ä»¤è·å–ç”¨æˆ·ä¿¡æ¯
3. åœ¨ä»ªè¡¨æ¿æ˜¾ç¤ºç»“æœ

### 2. æ‰‹åŠ¨è°ƒè¯•
å¦‚æœä»æœ‰é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹æ§åˆ¶å°
2. ç‚¹å‡»ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ä¸­çš„"ğŸ” æµ‹è¯•è¿æ¥"æŒ‰é’®
3. æŸ¥çœ‹è¯¦ç»†è¯Šæ–­ä¿¡æ¯

## ğŸ“‹ è¯¦ç»†æ—¥å¿—

ç°åœ¨è·å–ç”¨æˆ·ä¿¡æ¯æ—¶ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š

```
ğŸš€ è‡ªåŠ¨è¿æ¥æˆåŠŸ: LeagueClient (12345) ç«¯å£: 54321
ğŸ® å¼€å§‹è·å–ç”¨æˆ·ä¿¡æ¯...
ğŸ“¡ å¼€å§‹è·å–å¬å”¤å¸ˆä¿¡æ¯...
ğŸ” ä½¿ç”¨Token: AbCdEfGh...
ğŸŒ è¿æ¥ç«¯å£: 54321
ğŸ”— APIåœ°å€: https://127.0.0.1:54321
ğŸ“ è°ƒç”¨ /lol-summoner/v1/current-summoner API...
ğŸš€ ä½¿ç”¨Tauriå‘½ä»¤è°ƒç”¨LCP API...
ğŸ“¡ è°ƒç”¨LCP API: /lol-summoner/v1/current-summoner
ğŸ”— åœ°å€: https://127.0.0.1:54321/lol-summoner/v1/current-summoner
âœ… LCP APIè°ƒç”¨æˆåŠŸ
âœ… Tauri LCP APIè°ƒç”¨æˆåŠŸï¼Œæ•°æ®: {...}
ğŸ† å¼€å§‹è·å–æ’ä½ä¿¡æ¯...
ğŸ“Š æ’ä½æ•°æ®åŸå§‹ä¿¡æ¯: {...}
ğŸ¥‡ å•åŒæ’ä½ä¿¡æ¯: {...}
ğŸ‰ ç”¨æˆ·ä¿¡æ¯è·å–æˆåŠŸ!
ğŸ‘¨â€ğŸ’¼ å®Œæ•´ç”¨æˆ·ä¿¡æ¯: {...}
```

## ğŸ”§ æŠ€æœ¯å®ç°

### Ruståç«¯ (src-tauri/src/main.rs)
```rust
#[tauri::command]
async fn call_lcp_api(
    state: tauri::State<'_, AppState>,
    path: String,
) -> Result<serde_json::Value, String> {
    // ä½¿ç”¨reqwestå¿½ç•¥SSLè¯ä¹¦éªŒè¯
    let client = reqwest::ClientBuilder::new()
        .danger_accept_invalid_certs(true)
        .danger_accept_invalid_hostnames(true)
        .build()?;

    // å‘é€HTTPSè¯·æ±‚åˆ°League Client
    let response = client.get(&url)
        .header("Authorization", format!("Basic {}", auth))
        .send().await?;

    Ok(response.json().await?)
}
```

### å‰ç«¯è°ƒç”¨ (src/stores/useGameStore.ts)
```typescript
// ä½¿ç”¨Tauriå‘½ä»¤è€Œä¸æ˜¯ç›´æ¥fetch
const rawData = await invoke('call_lcp_api', {
  path: '/lol-summoner/v1/current-summoner'
})
const summonerData = rawData as Summoner
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¦‚æœä»ç„¶æŠ¥é”™ï¼š

#### 1. æ£€æŸ¥League ClientçŠ¶æ€
```bash
# ç¡®è®¤League Clientæ­£åœ¨è¿è¡Œ
tasklist | findstr "LeagueClient"
```

#### 2. æ£€æŸ¥ç«¯å£è¿é€šæ€§
```bash
# æµ‹è¯•ç«¯å£ï¼ˆæ›¿æ¢ä¸ºå®é™…ç«¯å£ï¼‰
telnet 127.0.0.1 54321
```

#### 3. æŸ¥çœ‹è¯¦ç»†é”™è¯¯
- æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)
- æŸ¥çœ‹Consoleæ ‡ç­¾é¡µ
- å¯»æ‰¾å¸¦æœ‰ âŒ å›¾æ ‡çš„é”™è¯¯ä¿¡æ¯

#### 4. æ‰‹åŠ¨è¯Šæ–­
- åœ¨ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ä¸­ç‚¹å‡»"ğŸ” æµ‹è¯•è¿æ¥"
- æŸ¥çœ‹è¯Šæ–­æŠ¥å‘Šå’Œå»ºè®®

### å¸¸è§é”™è¯¯è§£å†³ï¼š

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|----------|
| `HTTP 404` | APIè·¯å¾„é”™è¯¯ | æ£€æŸ¥League Clientç‰ˆæœ¬å…¼å®¹æ€§ |
| `HTTP 401` | è®¤è¯å¤±è´¥ | Tokenå¯èƒ½å·²è¿‡æœŸï¼Œé‡æ–°è¿æ¥ |
| `HTTP 500` | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | League Clientå¯èƒ½æœ‰é—®é¢˜ï¼Œé‡å¯å®¢æˆ·ç«¯ |
| `ECONNREFUSED` | è¿æ¥è¢«æ‹’ç» | ç¡®è®¤League Clientæ­£åœ¨è¿è¡Œ |
| `timeout` | è¿æ¥è¶…æ—¶ | æ£€æŸ¥ç½‘ç»œå’Œé˜²ç«å¢™è®¾ç½® |

## âœ… éªŒè¯è§£å†³æ–¹æ¡ˆ

æˆåŠŸè§£å†³åï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š
1. âœ… æ§åˆ¶å°æ˜¾ç¤ºæˆåŠŸæ—¥å¿—
2. ğŸ¨ ä»ªè¡¨æ¿æ˜¾ç¤ºæ¼‚äº®çš„ç”¨æˆ·ä¿¡æ¯å¡ç‰‡
3. ğŸ“Š åŒ…å«å¤´åƒã€ç­‰çº§ã€æ’ä½ç­‰å®Œæ•´ä¿¡æ¯
4. ğŸ”„ å¯ä»¥æ‰‹åŠ¨åˆ·æ–°è·å–æœ€æ–°æ•°æ®

## ğŸ¯ æ€»ç»“

è¿™ä¸ªè§£å†³æ–¹æ¡ˆé€šè¿‡ä»¥ä¸‹æ–¹å¼å½»åº•è§£å†³äº†è°ƒç”¨ç”¨æˆ·ä¿¡æ¯çš„æŠ¥é”™é—®é¢˜ï¼š

1. **ç»•è¿‡HTTPSè¯ä¹¦éªŒè¯** - ä½¿ç”¨Ruståç«¯å¤„ç†SSLè¿æ¥
2. **è¯¦ç»†é”™è¯¯è¯Šæ–­** - æä¾›å®Œæ•´çš„é—®é¢˜åˆ†æå·¥å…·
3. **å‹å¥½çš„ç”¨æˆ·ç•Œé¢** - ç¾è§‚çš„ä¿¡æ¯å±•ç¤ºå’ŒçŠ¶æ€åé¦ˆ
4. **å®Œå–„çš„æ—¥å¿—ç³»ç»Ÿ** - ä¾¿äºè°ƒè¯•å’Œé—®é¢˜å®šä½

ç°åœ¨ä½ å¯ä»¥æ”¾å¿ƒä½¿ç”¨è¿™ä¸ªåŠŸèƒ½äº†ï¼ğŸ®âœ¨
